!function o(n,a,h){function l(i,t){if(!a[i]){if(!n[i]){var e="function"==typeof require&&require;if(!t&&e)return e(i,!0);if(u)return u(i,!0);var r=new Error("Cannot find module '"+i+"'");throw r.code="MODULE_NOT_FOUND",r}var s=a[i]={exports:{}};n[i][0].call(s.exports,function(t){var e=n[i][1][t];return l(e||t)},s,s.exports,o,n,a,h)}return a[i].exports}for(var u="function"==typeof require&&require,t=0;t<h.length;t++)l(h[t]);return l}({1:[function(t,e,i){var r=t("./TypedNeuQuant.js"),s=t("./LZWEncoder.js");function o(){this.page=-1,this.pages=[],this.newPage()}o.pageSize=4096,o.charMap={};for(var n=0;n<256;n++)o.charMap[n]=String.fromCharCode(n);function a(t,e){this.width=~~t,this.height=~~e,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.neuQuant=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.dither=!1,this.globalPalette=!1,this.out=new o}o.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(o.pageSize),this.cursor=0},o.prototype.getData=function(){for(var t="",e=0;e<this.pages.length;e++)for(var i=0;i<o.pageSize;i++)t+=o.charMap[this.pages[e][i]];return t},o.prototype.writeByte=function(t){this.cursor>=o.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=t},o.prototype.writeUTFBytes=function(t){for(var e=t.length,i=0;i<e;i++)this.writeByte(t.charCodeAt(i))},o.prototype.writeBytes=function(t,e,i){for(var r=i||t.length,s=e||0;s<r;s++)this.writeByte(t[s])},a.prototype.setDelay=function(t){this.delay=Math.round(t/10)},a.prototype.setFrameRate=function(t){this.delay=Math.round(100/t)},a.prototype.setDispose=function(t){0<=t&&(this.dispose=t)},a.prototype.setRepeat=function(t){this.repeat=t},a.prototype.setTransparent=function(t){this.transparent=t},a.prototype.addFrame=function(t){this.image=t,this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null,this.getImagePixels(),this.analyzePixels(),!0===this.globalPalette&&(this.globalPalette=this.colorTab),this.firstFrame&&(this.writeLSD(),this.writePalette(),0<=this.repeat&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),this.firstFrame||this.globalPalette||this.writePalette(),this.writePixels(),this.firstFrame=!1},a.prototype.finish=function(){this.out.writeByte(59)},a.prototype.setQuality=function(t){t<1&&(t=1),this.sample=t},a.prototype.setDither=function(t){!0===t&&(t="FloydSteinberg"),this.dither=t},a.prototype.setGlobalPalette=function(t){this.globalPalette=t},a.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette},a.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")},a.prototype.analyzePixels=function(){this.colorTab||(this.neuQuant=new r(this.pixels,this.sample),this.neuQuant.buildColormap(),this.colorTab=this.neuQuant.getColormap()),this.dither?this.ditherPixels(this.dither.replace("-serpentine",""),null!==this.dither.match(/-serpentine/)):this.indexPixels(),this.pixels=null,this.colorDepth=8,this.palSize=7,null!==this.transparent&&(this.transIndex=this.findClosest(this.transparent,!0))},a.prototype.indexPixels=function(t){var e=this.pixels.length/3;this.indexedPixels=new Uint8Array(e);for(var i=0,r=0;r<e;r++){var s=this.findClosestRGB(255&this.pixels[i++],255&this.pixels[i++],255&this.pixels[i++]);this.usedEntry[s]=!0,this.indexedPixels[r]=s}},a.prototype.ditherPixels=function(t,e){var i={FalseFloydSteinberg:[[3/8,1,0],[3/8,0,1],[.25,1,1]],FloydSteinberg:[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]],Stucki:[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]],Atkinson:[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]]};if(!t||!i[t])throw"Unknown dithering kernel: "+t;var r=i[t],s=0,o=this.height,n=this.width,a=this.pixels,h=e?-1:1;this.indexedPixels=new Uint8Array(this.pixels.length/3);for(var l=0;l<o;l++){e&&(h*=-1);for(var u=1==h?0:n-1,p=1==h?n:0;u!==p;u+=h){var f=3*(s=l*n+u),c=a[f],y=a[f+1],w=a[f+2];f=this.findClosestRGB(c,y,w),this.usedEntry[f]=!0,this.indexedPixels[s]=f,f*=3;for(var d=c-this.colorTab[f],g=y-this.colorTab[f+1],x=w-this.colorTab[f+2],b=1==h?0:r.length-1,v=1==h?r.length:0;b!==v;b+=h){var P=r[b][1],m=r[b][2];if(0<=P+u&&P+u<n&&0<=m+l&&m+l<o){var B=r[b][0];f=s+P+m*n,a[f*=3]=Math.max(0,Math.min(255,a[f]+d*B)),a[f+1]=Math.max(0,Math.min(255,a[f+1]+g*B)),a[f+2]=Math.max(0,Math.min(255,a[f+2]+x*B))}}}}},a.prototype.findClosest=function(t,e){return this.findClosestRGB((16711680&t)>>16,(65280&t)>>8,255&t,e)},a.prototype.findClosestRGB=function(t,e,i,r){if(null===this.colorTab)return-1;if(this.neuQuant&&!r)return this.neuQuant.lookupRGB(t,e,i);for(var s=0,o=16777216,n=this.colorTab.length,a=0,h=0;a<n;h++){var l=t-(255&this.colorTab[a++]),u=e-(255&this.colorTab[a++]),p=i-(255&this.colorTab[a++]),f=l*l+u*u+p*p;(!r||this.usedEntry[h])&&f<o&&(o=f,s=h)}return s},a.prototype.getImagePixels=function(){var t=this.width,e=this.height;this.pixels=new Uint8Array(t*e*3);for(var i=this.image,r=0,s=0,o=0;o<e;o++)for(var n=0;n<t;n++)this.pixels[s++]=i[r++],this.pixels[s++]=i[r++],this.pixels[s++]=i[r++],r++},a.prototype.writeGraphicCtrlExt=function(){var t,e;this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4),null===this.transparent?e=t=0:(t=1,e=2),0<=this.dispose&&(e=7&dispose),e<<=2,this.out.writeByte(0|e|t),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)},a.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame||this.globalPalette?this.out.writeByte(0):this.out.writeByte(128|this.palSize)},a.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)},a.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE2.0"),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)},a.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);for(var t=768-this.colorTab.length,e=0;e<t;e++)this.out.writeByte(0)},a.prototype.writeShort=function(t){this.out.writeByte(255&t),this.out.writeByte(t>>8&255)},a.prototype.writePixels=function(){new s(this.width,this.height,this.indexedPixels,this.colorDepth).encode(this.out)},a.prototype.stream=function(){return this.out},e.exports=a},{"./LZWEncoder.js":2,"./TypedNeuQuant.js":3}],2:[function(t,e,i){var B=-1,S=12,T=5003,F=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];e.exports=function(e,i,t,r){var s,u,p,f,c,y,o=Math.max(2,r),n=new Uint8Array(256),w=new Int32Array(T),d=new Int32Array(T),a=0,g=0,x=!1;function h(t,e){n[u++]=t,254<=u&&l(e)}function b(t){for(var e=0;e<t;++e)w[e]=-1}function l(t){0<u&&(t.writeByte(u),t.writeBytes(n,0,u),u=0)}function v(t){return(1<<t)-1}function P(){return 0===remaining?B:(--remaining,255&t[curPixel++])}function m(t,e){for(s&=F[a],0<a?s|=t<<a:s=t,a+=n_bits;8<=a;)h(255&s,e),s>>=8,a-=8;if((p<g||x)&&(x?(p=v(n_bits=f),x=!1):(++n_bits,p=n_bits==S?1<<S:v(n_bits))),t==y){for(;0<a;)h(255&s,e),s>>=8,a-=8;l(e)}}this.encode=function(t){t.writeByte(o),remaining=e*i,curPixel=0,function(t,e){var i,r,s,o,n,a,h,l;for(f=t,x=!1,n_bits=f,p=v(n_bits),y=1+(c=1<<t-1),g=c+2,u=0,o=P(),h=0,i=T;i<65536;i*=2)++h;h=8-h,b(a=T),m(c,e);t:for(;(r=P())!=B;)if(i=(r<<S)+o,w[s=r<<h^o]!==i){if(0<=w[s]){n=a-s,0===s&&(n=1);do{if((s-=n)<0&&(s+=a),w[s]===i){o=d[s];continue t}}while(0<=w[s])}m(o,e),o=r,g<1<<S?(d[s]=g++,w[s]=i):(l=e,b(T),g=c+2,x=!0,m(c,l))}else o=d[s];m(o,e),m(y,e)}(o+1,t),t.writeByte(0)}}},{}],3:[function(t,e,i){var T=100,y=256,h=y-1,F=4,w=16,r=1<<w,d=10,g=10,x=r>>g,M=r<<d-g,C=6,A=(y>>3)*(1<<C),E=30,I=1024,D=256,G=1<<18,z=499,U=491,Q=487,R=503,_=3*R;e.exports=function(b,v){var P,u,f,c,m;function B(t,e,i,r,s){for(var o,n,a=Math.abs(e-t),h=Math.min(e+t,y),l=e+1,u=e-1,p=1;l<h||a<u;)n=m[p++],l<h&&((o=P[l++])[0]-=n*(o[0]-i)/G,o[1]-=n*(o[1]-r)/G,o[2]-=n*(o[2]-s)/G),a<u&&((o=P[u--])[0]-=n*(o[0]-i)/G,o[1]-=n*(o[1]-r)/G,o[2]-=n*(o[2]-s)/G)}function S(t,e,i){var r,s,o,n,a,h=~(1<<31),l=h,u=-1,p=u;for(r=0;r<y;r++)s=P[r],(o=Math.abs(s[0]-t)+Math.abs(s[1]-e)+Math.abs(s[2]-i))<h&&(h=o,u=r),(n=o-(f[r]>>w-F))<l&&(l=n,p=r),a=c[r]>>g,c[r]-=a,f[r]+=a<<d;return c[u]+=x,f[u]-=M,p}this.buildColormap=function(){!function(){var t,e;for(P=[],u=new Int32Array(256),f=new Int32Array(y),c=new Int32Array(y),m=new Int32Array(y>>3),t=0;t<y;t++)e=(t<<F+8)/y,P[t]=new Float64Array([e,e,e,0]),c[t]=r/y,f[t]=0}(),function(){var t,e,i,r,s,o,n=b.length,a=30+(v-1)/3,h=n/(3*v),l=~~(h/T),u=I,p=A,f=p>>C;for(f<=1&&(f=0),t=0;t<f;t++)m[t]=u*((f*f-t*t)*D/(f*f));n<_?(v=1,e=3):e=n%z!=0?3*z:n%U!=0?3*U:n%Q!=0?3*Q:3*R;var c,y,w,d,g,x=0;for(t=0;t<h;)if(o=S(i=(255&b[x])<<F,r=(255&b[x+1])<<F,s=(255&b[x+2])<<F),c=u,w=i,d=r,g=s,P[y=o][0]-=c*(P[y][0]-w)/I,P[y][1]-=c*(P[y][1]-d)/I,P[y][2]-=c*(P[y][2]-g)/I,0!==f&&B(f,o,i,r,s),n<=(x+=e)&&(x-=n),0===l&&(l=1),++t%l==0)for(u-=u/a,(f=(p-=p/E)>>C)<=1&&(f=0),o=0;o<f;o++)m[o]=u*((f*f-o*o)*D/(f*f))}(),function(){for(var t=0;t<y;t++)P[t][0]>>=F,P[t][1]>>=F,P[t][2]>>=F,P[t][3]=t}(),function(){var t,e,i,r,s,o,n=0,a=0;for(t=0;t<y;t++){for(o=(i=P[s=t])[1],e=t+1;e<y;e++)(r=P[e])[1]<o&&(s=e,o=r[1]);if(r=P[s],t!=s&&(e=r[0],r[0]=i[0],i[0]=e,e=r[1],r[1]=i[1],i[1]=e,e=r[2],r[2]=i[2],i[2]=e,e=r[3],r[3]=i[3],i[3]=e),o!=n){for(u[n]=a+t>>1,e=n+1;e<o;e++)u[e]=t;n=o,a=t}}for(u[n]=a+h>>1,e=n+1;e<256;e++)u[e]=h}()},this.getColormap=function(){for(var t=[],e=[],i=0;i<y;i++)e[P[i][3]]=i;for(var r=0,s=0;s<y;s++){var o=e[s];t[r++]=P[o][0],t[r++]=P[o][1],t[r++]=P[o][2]}return t},this.lookupRGB=function(t,e,i){for(var r,s,o,n=1e3,a=-1,h=u[e],l=h-1;h<y||0<=l;)h<y&&(n<=(o=(s=P[h])[1]-e)?h=y:(h++,o<0&&(o=-o),(r=s[0]-t)<0&&(r=-r),(o+=r)<n&&((r=s[2]-i)<0&&(r=-r),(o+=r)<n&&(n=o,a=s[3])))),0<=l&&(n<=(o=e-(s=P[l])[1])?l=-1:(l--,o<0&&(o=-o),(r=s[0]-t)<0&&(r=-r),(o+=r)<n&&((r=s[2]-i)<0&&(r=-r),(o+=r)<n&&(n=o,a=s[3]))));return a}}},{}],4:[function(t,e,i){var r,s;r=t("./GIFEncoder.js"),s=function(s){var t,o,e,i;return t=new r(s.width,s.height),0===s.index?t.writeHeader():t.firstFrame=!1,t.setTransparent(s.transparent),t.setRepeat(s.repeat),t.setDelay(s.delay),t.setQuality(s.quality),t.setDither(s.dither),t.setGlobalPalette(s.globalPalette),t.addFrame(s.data),s.last&&t.finish(),!0===s.globalPalette&&(s.globalPalette=t.getGlobalPalette()),e=t.stream(),s.data=e.pages,s.cursor=e.cursor,s.pageSize=e.constructor.pageSize,s.canTransfer?(i=function(){var t,e,i,r;for(r=[],t=0,e=(i=s.data).length;t<e;t++)o=i[t],r.push(o.buffer);return r}(),self.postMessage(s,i)):self.postMessage(s)},self.onmessage=function(t){return s(t.data)}},{"./GIFEncoder.js":1}]},{},[4]);